import { SheetAccess, Action, EnumProperty, Property, SheetConfig } from '@flatfile/blueprint';

interface IJsonSchemaProperty {
    title?: string;
    description?: string;
    enum?: string[];
    enumArray?: {
        label: string;
        value: string;
    }[];
    enumLabel?: string[];
    enumLabelArray?: string[];
    field?: string;
    format?: string;
    isMultiple?: boolean;
    enumMatch?: 'exact' | undefined;
    items?: {
        type: string | string[];
        enum?: {
            label: string;
            value: string;
        }[];
        enumLabel?: string[];
        pattern?: string;
        format?: string;
    };
    label: string;
    minimum?: number;
    maximum?: number;
    regexp?: {
        cache?: RegExp;
        pattern: string;
        flags: string;
        ignoreBlanks?: boolean;
    };
    required?: boolean;
    type: string | string[];
    exportDateFormat?: string;
    unique?: boolean;
    pattern?: string;
    primary?: boolean;
    $schemaId?: string;
    upsert?: boolean;
    default?: string;
    custom?: boolean;
    visibility?: FieldVisibilityTypes;
}
type FieldVisibilityTypes = {
    mapping?: boolean;
    review?: boolean;
    export?: boolean;
};
interface IJsonSchema {
    properties: Record<string, IJsonSchemaProperty>;
    type: string;
    name?: string;
    required?: string[];
    unique?: string[];
    primary?: string;
    linkedProperties?: Record<string, IJsonSchemaProperty>;
    allowCustomFields?: boolean;
}

type BaseFieldTypes = 'string' | 'number' | 'boolean' | 'composite';
interface BaseField {
    field: string;
    label: string;
    description?: string;
    required?: boolean;
    primary?: boolean;
    unique?: boolean;
    readonly?: boolean;
    stageVisibility?: FieldVisibilityTypes;
    annotations: {
        default?: boolean;
        defaultMessage?: string;
        compute?: boolean;
        computeMessage?: string;
    };
    contributeToRecordCompute?: any;
    getSheetCompute?: any;
    blueprint?: any;
}
interface BaseSchemaILField extends BaseField {
    type: BaseFieldTypes;
}
interface BaseSchemaILFieldArgs extends Omit<BaseSchemaILField, 'field'> {
}
type EnumOption = {
    value: string | number | boolean;
    label: string;
};
interface SchemaILEnumField extends BaseField {
    type: 'enum';
    matchStrategy: 'fuzzy' | 'exact';
    labelEnum: Array<EnumOption>;
}
interface LinkedSheetField extends BaseField {
    type: 'schema_ref';
    sheetName: string;
    upsert: boolean;
}
interface ReferenceField extends BaseField {
    type: 'reference';
    sheetKey: string;
    foreignKey: string;
    relationship?: 'has-one' | 'has-many';
}
type SchemaILFieldArgs = Omit<BaseSchemaILField, 'field'> | Omit<SchemaILEnumField, 'field'> | Omit<LinkedSheetField, 'field'> | Omit<ReferenceField, 'field'>;
type SchemaILField = BaseSchemaILField | SchemaILEnumField | LinkedSheetField | ReferenceField;
interface SchemaILModel<Fields extends Record<string, SchemaILField> = Record<string, SchemaILField>> {
    name: string;
    slug: string;
    namespace: string;
    fields: Fields;
    access?: SheetAccess[];
    readonly?: boolean;
    required?: Array<keyof Fields | Array<keyof Fields>>;
    unique?: Array<keyof Fields | Array<keyof Fields>>;
    primary?: keyof Fields;
    allowCustomFields: boolean;
    actions?: Array<Action>;
}

declare const compileEnum: (inputField: SchemaILEnumField) => IJsonSchemaProperty;
declare const compileLinkedField: (inputField: LinkedSheetField) => IJsonSchemaProperty;
declare const compileSpecific: (inputField: SchemaILField) => IJsonSchemaProperty;
declare const SchemaILToJsonSchema: (ddl: SchemaILModel) => IJsonSchema;
declare const compileToJsonSchema: (ddl: SchemaILModel) => IJsonSchema;

declare const convertEnum: (field: SchemaILEnumField) => EnumProperty;
declare const SchemaILFieldtoProperty: (field: SchemaILField) => Property;
declare const SchemaILModelToSheetConfig: (model: SchemaILModel) => SheetConfig;

export { BaseFieldTypes, BaseSchemaILField, BaseSchemaILFieldArgs, EnumOption, FieldVisibilityTypes, IJsonSchema, IJsonSchemaProperty, LinkedSheetField, ReferenceField, SchemaILEnumField, SchemaILField, SchemaILFieldArgs, SchemaILFieldtoProperty, SchemaILModel, SchemaILModelToSheetConfig, SchemaILToJsonSchema, compileEnum, compileLinkedField, compileSpecific, compileToJsonSchema, convertEnum };
